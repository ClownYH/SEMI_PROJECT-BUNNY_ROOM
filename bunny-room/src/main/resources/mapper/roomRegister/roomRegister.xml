<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yyc.bunnyroom.roomRegister.dao.RoomRegisterMapper">


    <!--BusinessDTO-->
    <resultMap id="businessDTO" type="com.yyc.bunnyroom.roomRegister.model.BusinessDTO">
        <id property="businessNo" column="BUSINESS_NO"/>
        <result property="userNo" column="USER_NO"/>
        <result property="businessName" column="BUSINESS_NAME"/>
        <result property="businessRegistNo" column="BUSINESS_REGIST_NO"/>
        <result property="businessCategoryNo" column="BUSINESS_CATEGORY_NO"/>
        <result property="businessAddressRoad" column="BUSINESS_ADDRESS_ROAD"/>
        <result property="businessAddressDetail" column="BUSINESS_ADDRESS_DETAIL"/>
        <result property="businessZipCode" column="BUSINESS_ZIP_CODE"/>
        <result property="businessPhone" column="BUSINESS_PHONE"/>
        <result property="businessRegistDate" column="BUSINESS_REGIST_DATE"/>
        <result property="businessUpdateDate" column="BUSINESS_UPDATE_DATE"/>
        <result property="businessStatus" column="BUSINESS_STATUS"/>
    </resultMap>

    <!--BusinessCategoryDTO-->
    <resultMap id="businessCategoryDTO" type="com.yyc.bunnyroom.roomRegister.model.BusinessCategoryDTO">
        <id property="businessCategoryNo" column="BUSINESS_CATEGORY_NO"/>
        <result property="businessCategoryName" column="BUSINESS_CATEGORY_NAME"/>
        <result property="businessCategoryColorCode" column="BUSINESS_CATEGORY_COLOR_CODE"/>
        <result property="businessCategoryStatus" column="BUSINESS_CATEGORY_STATUS"/>
    </resultMap>

    <!--RoomOptionDTO-->
    <resultMap id="roomOptionDTO" type="com.yyc.bunnyroom.roomRegister.model.RoomOptionDTO">
        <id property="optionIdx" column="OPTION_NO"/>
        <result property="optionName" column="OPTION_NAME"/>
    </resultMap>




    <!--HolidayDTO-->

    <!--closedDaysRegister-->
    <insert id="closedDaysRegister" parameterType="com.yyc.bunnyroom.roomRegister.model.ClosedDayDTO">
        INSERT INTO TBL_CLOSED_DAY
        (
            CLOSED_DAY_NO,
            CLOSED_DAY,
            BUSINESS_NO
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
        (
            NULL,
            #{item.closedDay},
            #{item.businessNo}
        )
        </foreach>
    </insert>


    <!-- holidaysRegister -->
    <insert id="holidaysRegister" parameterType="com.yyc.bunnyroom.roomRegister.model.HolidayDTO">
        INSERT INTO TBL_HOLIDAY
        (
            HOLIDAY_NO,
            BUSINESS_NO,
            HOLIDAY_NAME,
            HOLIDAY_REASON,
            HOLIDAY_START_DATE,
            HOLIDAY_END_DATE,
            HOLIDAY_REGIST_DATE,
            HOLIDAY_STATUS
        )
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
        (
           NULL,
            #{item.businessNo},
            #{item.holidayName},
            #{item.reason},
            #{item.startDate},
            #{item.endDate},
            #{item.registDate},
            #{item.activeStatus}
        )
        </foreach>
    </insert>











    <!--RoomDTO-->

    <!--VacationDTO-->






    <!--모든 사업체 카테고리 가져옴 (active)-->
    <select id="selectAllBusinessCategory" resultMap="businessCategoryDTO">
        SELECT
            BUSINESS_CATEGORY_NO,
            BUSINESS_CATEGORY_NAME,
            BUSINESS_CATEGORY_COLOR_CODE
          FROM TBL_BUSINESS_CATEGORY
         WHERE BUSINESS_CATEGORY_STATUS = 'active'
    </select>

    <!--모든 방 옵션을 가져옴-->
    <select id="selectAllRoomOptions" resultMap="roomOptionDTO">
        SELECT
            OPTION_NO,
            OPTION_NAME
        FROM TBL_ROOM_OPTION
    </select>

    <!--getAllBusiness (모든 사업체를 가져옴)-->
    <select id="getAllBusiness" resultMap="businessDTO">
        SELECT
            BUSINESS_NO,
            USER_NO,
            BUSINESS_REGIST_NO,
            BUSINESS_NAME,
            BUSINESS_CATEGORY_NO,
            BUSINESS_ADDRESS_ROAD,
            BUSINESS_ADDRESS_DETAIL,
            BUSINESS_ZIP_CODE,
            BUSINESS_PHONE,
            BUSINESS_REGIST_DATE,
            BUSINESS_UPDATE_DATE,
            BUSINESS_STATUS
        FROM TBL_BUSINESS
        WHERE USER_NO = #{ownerNo}
          AND BUSINESS_STATUS = 'active'
    </select>


    <!--getBusinessDetails (사업번호를 이용해서 사업체 상세 내역을 가져옴)-->
    <select id="getBusinessDetails" resultMap="businessDTO">
        SELECT
            BUSINESS_NO,
            USER_NO,
            BUSINESS_REGIST_NO,
            BUSINESS_NAME,
            BUSINESS_CATEGORY_NO,
            BUSINESS_ADDRESS_ROAD,
            BUSINESS_ADDRESS_DETAIL,
            BUSINESS_ZIP_CODE,
            BUSINESS_PHONE,
            BUSINESS_REGIST_DATE,
            BUSINESS_UPDATE_DATE,
            BUSINESS_STATUS
        FROM TBL_BUSINESS
        WHERE USER_NO = #{businessNo}
    </select>
















    <!--사업체 등록-->
    <insert id="businessRegister" parameterType="com.yyc.bunnyroom.roomRegister.model.BusinessDTO">
        INSERT INTO TBL_BUSINESS(
            BUSINESS_NO,
            USER_NO,
            BUSINESS_REGIST_NO,
            BUSINESS_NAME,
            BUSINESS_CATEGORY_NO,
            BUSINESS_ADDRESS_ROAD,
            BUSINESS_ADDRESS_DETAIL,
            BUSINESS_ZIP_CODE,
            BUSINESS_PHONE,
            BUSINESS_REGIST_DATE,
            BUSINESS_UPDATE_DATE,
            BUSINESS_STATUS
        )VALUES(
            NULL,
            #{userNo},
            #{businessRegistNo},
            #{businessName},
            #{businessCategoryNo},
            #{businessAddressRoad},
            #{businessAddressDetail},
            #{businessZipCode},
            #{businessPhone},
            #{businessRegistDate},
            #{businessUpdateDate},
            #{businessStatus}
        )
    </insert>












</mapper>